CREATE SERVER shard1
FOREIGN DATA WRAPPER mysql
OPTIONS(
  HOST '172.20.0.3',
  DATABASE 'test',
  USER 'spider',
  PASSWORD '12121212',
  PORT 3306
);


CREATE SERVER shard2
FOREIGN DATA WRAPPER mysql
OPTIONS(
  HOST '172.20.0.4',
  DATABASE 'test',
  USER 'spider',
  PASSWORD '12121212',
  PORT 3306
);

CREATE TABLE test.shardTest
(
  id int(10) unsigned NOT NULL AUTO_INCREMENT,
  name char(120) NOT NULL DEFAULT '',
  PRIMARY KEY (id)
) ENGINE=spider COMMENT='wrapper "mysql", table "shardTest"'
PARTITION BY KEY (id)
(
  PARTITION shard1 COMMENT = 'srv "shard1"',
  PARTITION shard2 COMMENT = 'srv "shard2"'
);

CREATE TABLE test.shardTest
(
  id int(10) unsigned NOT NULL AUTO_INCREMENT,
  name char(120) NOT NULL DEFAULT '',
  PRIMARY KEY (id)
) ENGINE=innodb;



CREATE TABLE test.employees (
  `emp_no` int(11) NOT NULL,
  `birth_date` date NOT NULL,
  `first_name` varchar(14) NOT NULL,
  `last_name` varchar(16) NOT NULL,
  `gender` enum('M','F') NOT NULL,
  `hire_date` date NOT NULL,
  PRIMARY KEY (`emp_no`)
) ENGINE=spider COMMENT='wrapper "mysql", table "employees"'
PARTITION BY KEY (emp_no)
(
  PARTITION shard1 COMMENT = 'srv "shard1"',
  PARTITION shard2 COMMENT = 'srv "shard2"'
);


CREATE TABLE test.employees (
  `emp_no` int(11) NOT NULL,
  `birth_date` date NOT NULL,
  `first_name` varchar(14) NOT NULL,
  `last_name` varchar(16) NOT NULL,
  `gender` enum('M','F') NOT NULL,
  `hire_date` date NOT NULL,
  PRIMARY KEY (`emp_no`)
) ENGINE=InnoDB

CREATE TABLE test.noShard (
  `emp_no` int(11) NOT NULL,
  `birth_date` date NOT NULL,
  `first_name` varchar(14) NOT NULL,
  `last_name` varchar(16) NOT NULL,
  `gender` enum('M','F') NOT NULL,
  `hire_date` date NOT NULL,
  PRIMARY KEY (`emp_no`)
) ENGINE=InnoDB
